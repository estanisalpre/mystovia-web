---
import { Search, Bot } from "@lucide/astro";
---

<header class="hidden md:block fixed top-[60px] left-0 right-0 z-800 h-[50px]">
  <div class="w-full h-full flex items-center justify-center px-4"
       style="background: linear-gradient(to bottom, rgb(17 24 39 / 0.95), rgb(17 24 39 / 0.9)); border-bottom: 1px solid rgb(234 179 8 / 0.15);">
    <!-- Diamond pattern overlay -->
    <div class="absolute inset-0 opacity-[0.02] pointer-events-none" style="background-image: url('data:image/svg+xml,%3Csvg width=\'60\' height=\'60\' viewBox=\'0 0 60 60\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M30 0L60 30L30 60L0 30z\' fill=\'%23d4af37\' fill-opacity=\'0.4\'/%3E%3C/svg%3E'); background-size: 30px 30px;"></div>
    <!-- Bottom golden line -->
    <div class="absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-yellow-500/30 to-transparent"></div>

    <!-- Search Form + Bot Guide Button -->
    <div class="relative z-10 flex items-center gap-4 w-full mt-2 max-w-[60%]">
      <form id="fixedSearchForm" class="flex-1 flex items-center gap-3">
        <div class="flex-1 relative">
          <input
            type="text"
            id="fixedCharacterName"
            placeholder="Buscar personaje..."
            class="w-full h-[34px] px-4 pr-10 text-sm bg-gray-800/60 border border-yellow-600/20 rounded-lg focus:outline-none focus:border-yellow-500/50 text-white placeholder-gray-500 transition-colors"
          />
          <Search class="absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500" />
        </div>
        <button
          type="submit"
          id="fixedSearchBtn"
          class="h-[34px] px-5 text-sm font-semibold bg-gradient-to-r from-yellow-600 to-yellow-500 hover:from-yellow-500 hover:to-yellow-400 text-black rounded-lg transition-all border border-yellow-400/30 whitespace-nowrap"
        >
          Buscar
        </button>
      </form>

      <!-- Bot Guide Button -->
      <a
        href="/guides"
        class="flex items-center gap-2 h-[34px] px-4 text-sm font-semibold bg-purple-600/20 hover:bg-purple-600/30 text-purple-300 hover:text-purple-200 rounded-lg transition-all border border-purple-500/30 hover:border-purple-500/50 whitespace-nowrap"
        title="Guías de configuración del Bot"
      >
        <Bot class="w-4 h-4" />
        <span class="hidden lg:inline">Config. Bot</span>
      </a>
    </div>
  </div>
</header>

<script>
  import { t, getStoredLanguage } from '../i18n/translations';

  function applyTranslations() {
    const lang = getStoredLanguage();

    const fixedInput = document.getElementById('fixedCharacterName') as HTMLInputElement;
    if (fixedInput) {
      fixedInput.placeholder = t('character.searchPlaceholder', lang) || 'Buscar personaje...';
    }

    const fixedSearchBtn = document.getElementById('fixedSearchBtn');
    if (fixedSearchBtn) {
      fixedSearchBtn.textContent = t('common.search', lang);
    }
  }

  function initSearchForm() {
    const fixedForm = document.getElementById('fixedSearchForm') as HTMLFormElement;
    fixedForm?.addEventListener('submit', (e) => {
      e.preventDefault();
      const input = document.getElementById('fixedCharacterName') as HTMLInputElement;
      const name = input?.value.trim();

      if (!name) {
        return;
      }

      window.location.href = `/character-information?name=${encodeURIComponent(name)}`;
    });
  }

  applyTranslations();
  initSearchForm();
  document.addEventListener('astro:page-load', applyTranslations);
</script>

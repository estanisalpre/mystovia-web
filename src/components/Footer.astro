---
import { MystoviaLogo } from "../assets/logos";
import { Instagram, Play, Users, HelpCircle, Star } from '@lucide/astro';
import DiamondPattern from "./ui/DiamondPattern.astro";
import GoldenLine from "./ui/GoldenLine.astro";
import CornerOrnaments from "./ui/CornerOrnaments.astro";
---

<footer class="relative bg-gradient-to-b from-gray-900 via-gray-900 to-black border-t border-yellow-600/30 mt-auto overflow-hidden">
  <!-- Decorative top border with medieval style -->
  <GoldenLine position="top" thickness="thick" opacity={0.5} />

  <!-- Subtle pattern overlay -->
  <DiamondPattern opacity={0.05} />

  <div class="relative container mx-auto px-4 py-12">
    <!-- Main footer content -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12">

      <!-- Brand section -->
      <section class="lg:col-span-1">
        <a href="/" class="inline-block mb-4">
          <img
            src={MystoviaLogo.src}
            alt="Mystovia Logo"
            class="w-36 h-auto hover:opacity-80 transition-opacity"
          />
        </a>
        <p id="footerDescription" class="text-gray-400 text-sm leading-relaxed mb-6">
          La mejor experiencia de servidor privado de Tibia. ¡Únete a miles de jugadores en épicas aventuras!
        </p>
        <!-- Social links -->
        <nav class="flex items-center gap-3" aria-label="Redes sociales">
          <a href="https://www.instagram.com/mystovia.online?igsh=MWoyZjhob3lndHRmeA==" class="w-10 h-10 rounded-lg bg-gray-800/50 border border-gray-700 hover:border-yellow-500/50 hover:bg-yellow-500/10 flex items-center justify-center text-gray-400 hover:text-yellow-500 transition-all duration-300" aria-label="Instagram" target="_blank" rel="noopener noreferrer">
            <Instagram class="w-5 h-5" />
          </a>
        </nav>
      </section>

      <!-- Game section -->
      <section>
        <h4 id="footerGameTitle" class="text-yellow-500 font-semibold mb-4 flex items-center gap-2">
          <Play class="w-4 h-4" fill="currentColor" aria-hidden="true" />
          Juego
        </h4>
        <ul class="space-y-2.5">
          <li>
            <button id="downloadClientLink" class="text-gray-400 hover:text-yellow-500 transition-colors text-sm flex items-center gap-2 group cursor-pointer">
              <span class="w-1 h-1 rounded-full bg-gray-600 group-hover:bg-yellow-500 transition-colors" aria-hidden="true"></span>
              Descargar Cliente
            </button>
          </li>
          <li>
            <a href="/marketplace" class="text-gray-400 hover:text-yellow-500 transition-colors text-sm flex items-center gap-2 group">
              <span class="w-1 h-1 rounded-full bg-gray-600 group-hover:bg-yellow-500 transition-colors" aria-hidden="true"></span>
              <span id="footerMarketplace">Marketplace</span>
            </a>
          </li>
          <li>
            <a href="/guides" class="text-gray-400 hover:text-yellow-500 transition-colors text-sm flex items-center gap-2 group">
              <span class="w-1 h-1 rounded-full bg-gray-600 group-hover:bg-yellow-500 transition-colors" aria-hidden="true"></span>
              Config. Bot
            </a>
          </li>
        </ul>
      </section>

      <!-- Community section -->
      <section>
        <h4 id="communityTitle" class="text-yellow-500 font-semibold mb-4 flex items-center gap-2">
          <Users class="w-4 h-4" aria-hidden="true" />
          Comunidad
        </h4>
        <ul class="space-y-2.5">
          <li>
            <a href="/news" class="text-gray-400 hover:text-yellow-500 transition-colors text-sm flex items-center gap-2 group">
              <span class="w-1 h-1 rounded-full bg-gray-600 group-hover:bg-yellow-500 transition-colors" aria-hidden="true"></span>
              <span id="footerNews">Noticias</span>
            </a>
          </li>
          <li>
            <a href="/forum" class="text-gray-400 hover:text-yellow-500 transition-colors text-sm flex items-center gap-2 group">
              <span class="w-1 h-1 rounded-full bg-gray-600 group-hover:bg-yellow-500 transition-colors" aria-hidden="true"></span>
              <span id="footerForum">Foro</span>
            </a>
          </li>
        </ul>
      </section>

      <!-- Support section -->
      <section>
        <h4 id="footerSupportTitle" class="text-yellow-500 font-semibold mb-4 flex items-center gap-2">
          <HelpCircle class="w-4 h-4" aria-hidden="true" />
          Soporte
        </h4>
        <ul class="space-y-2.5">
          <li>
            <a href="/rules" id="serverRulesLink" class="text-gray-400 hover:text-yellow-500 transition-colors text-sm flex items-center gap-2 group">
              <span class="w-1 h-1 rounded-full bg-gray-600 group-hover:bg-yellow-500 transition-colors" aria-hidden="true"></span>
              Reglas del Servidor
            </a>
          </li>
          <li>
            <a href="/lost-account" class="text-gray-400 hover:text-yellow-500 transition-colors text-sm flex items-center gap-2 group">
              <span class="w-1 h-1 rounded-full bg-gray-600 group-hover:bg-yellow-500 transition-colors" aria-hidden="true"></span>
              <span id="footerLostAccount">Cuenta Perdida</span>
            </a>
          </li>
        </ul>
      </section>
    </div>

    <!-- Decorative divider -->
    <figure class="my-8 flex items-center gap-4" aria-hidden="true">
      <span class="flex-1 h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"></span>
      <span class="flex items-center gap-2 text-yellow-600/50">
        <Star class="w-3 h-3" fill="currentColor" />
        <Star class="w-4 h-4" fill="currentColor" />
        <Star class="w-3 h-3" fill="currentColor" />
      </span>
      <span class="flex-1 h-px bg-gradient-to-r from-transparent via-gray-700 to-transparent"></span>
    </figure>

    <!-- Bottom bar -->
    <section class="flex flex-col md:flex-row items-center justify-between gap-4 text-sm">
      <p id="footerCopyright" class="text-gray-500 text-center md:text-left">
        &copy; 2025 Mystovia. Todos los derechos reservados. No afiliado con CipSoft GmbH.
      </p>
      <nav class="flex items-center gap-6 text-gray-500" aria-label="Enlaces legales">
        <a href="/terms" class="hover:text-yellow-500 transition-colors" id="footerTerms">Términos</a>
        <span class="text-gray-700" aria-hidden="true">|</span>
        <a href="/privacy" class="hover:text-yellow-500 transition-colors" id="footerPrivacy">Privacidad</a>
      </nav>
    </section>
  </div>

  <!-- Decorative corner ornaments -->
  <CornerOrnaments variant="curve" size="xl" opacity={0.1} offset={0} />
</footer>

<script>
  import { t, getStoredLanguage } from '../i18n/translations';

  function applyTranslations() {
    const lang = getStoredLanguage();

    const footerDesc = document.getElementById('footerDescription');
    if (footerDesc) footerDesc.textContent = t('footer.description', lang);

    const gameTitle = document.getElementById('footerGameTitle');
    if (gameTitle) {
      const icon = gameTitle.querySelector('svg');
      gameTitle.textContent = '';
      if (icon) gameTitle.appendChild(icon);
      gameTitle.appendChild(document.createTextNode(t('footer.game', lang)));
    }

    const community = document.getElementById('communityTitle');
    if (community) {
      const icon = community.querySelector('svg');
      community.textContent = '';
      if (icon) community.appendChild(icon);
      community.appendChild(document.createTextNode(t('footer.community', lang)));
    }

    const supportTitle = document.getElementById('footerSupportTitle');
    if (supportTitle) {
      const icon = supportTitle.querySelector('svg');
      supportTitle.textContent = '';
      if (icon) supportTitle.appendChild(icon);
      supportTitle.appendChild(document.createTextNode(t('footer.support', lang)));
    }

    const downloadClient = document.getElementById('downloadClientLink');
    if (downloadClient) {
      const bullet = downloadClient.querySelector('span');
      downloadClient.textContent = '';
      if (bullet) downloadClient.appendChild(bullet);
      downloadClient.appendChild(document.createTextNode(t('footer.downloadClient', lang)));

      downloadClient.addEventListener('click', () => {
        window.dispatchEvent(new CustomEvent('openDownloadModal'));
      });
    }

    const serverRules = document.getElementById('serverRulesLink');
    if (serverRules) {
      const bullet = serverRules.querySelector('span');
      serverRules.textContent = '';
      if (bullet) serverRules.appendChild(bullet);
      serverRules.appendChild(document.createTextNode(t('footer.serverRules', lang)));
    }

    const marketplace = document.getElementById('footerMarketplace');
    if (marketplace) marketplace.textContent = t('footer.marketplace', lang);

    const characters = document.getElementById('footerCharacters');
    if (characters) characters.textContent = t('footer.searchCharacters', lang);

    const news = document.getElementById('footerNews');
    if (news) news.textContent = t('footer.news', lang);

    const forum = document.getElementById('footerForum');
    if (forum) forum.textContent = t('footer.forum', lang);

    const support = document.getElementById('footerSupport');
    if (support) support.textContent = t('footer.helpCenter', lang);

    const lostAccount = document.getElementById('footerLostAccount');
    if (lostAccount) lostAccount.textContent = t('footer.lostAccount', lang);

    const terms = document.getElementById('footerTerms');
    if (terms) terms.textContent = t('footer.terms', lang);

    const privacy = document.getElementById('footerPrivacy');
    if (privacy) privacy.textContent = t('footer.privacy', lang);

    const copyright = document.getElementById('footerCopyright');
    if (copyright) copyright.textContent = `© 2025 Mystovia. ${t('footer.allRightsReserved', lang)}`;
  }

  // Run on initial load and on View Transitions navigation
  applyTranslations();
  document.addEventListener('astro:page-load', applyTranslations);
</script>

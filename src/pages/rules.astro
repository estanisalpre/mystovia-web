---
import Layout from "@layouts/Layout.astro";
import { BookOpenText, AlertTriangle, Info, Shield, Swords, MessageSquare, Scale, ShoppingBag, Gavel, Diamond, ArrowUp } from "@lucide/astro";
import DiamondPattern from "../components/ui/DiamondPattern.astro";
import GoldenLine from "../components/ui/GoldenLine.astro";
import CornerOrnaments from "../components/ui/CornerOrnaments.astro";

// Reglas del servidor - Contenido estático
const sections = [
  {
    id: 1,
    name: "Reglas principales",
    icon: "Shield",
    rules: [
      {
        title: "Nombre que viole la regla de soporte",
        content: "Queda estrictamente prohibido cualquier nombre que pueda confundirse con el de los miembros de soporte o administración, como \"GM\", \"Admin\", \"Soporte\" o cualquier variación que sugiera autoridad dentro del juego. Esto incluye nombres que puedan inducir a otros jugadores a creer que el titular tiene poderes o responsabilidades administrativas. Estos nombres cambiarán de inmediato."
      },
      {
        title: "Nombre Ofensivo",
        content: "Los nombres ofensivos incluyen, entre otros, comentarios racistas o sexistas, o cualquier forma de incitación al odio. El objetivo es garantizar un entorno de juego respetuoso y seguro para todos los jugadores. La administración cambiará los nombres que infrinjan esta regla."
      },
      {
        title: "Simular ser parte del equipo de Mystovia",
        content: "Cualquier intento de engañar a otros jugadores haciéndoles creer que eres parte del personal o la administración del servidor constituye una infracción grave. Esto incluye usar nombres, títulos o cualquier comportamiento que sugiera falsamente autoridad o afiliación oficial."
      },
      {
        title: "Calumnias o información falsa sobre la empresa",
        content: "Está estrictamente prohibido difundir rumores, información falsa o cualquier tipo de difamación sobre la empresa, su equipo o sus servicios. Esto incluye publicar información engañosa en canales, redes sociales, Discord o cualquier otro medio de comunicación. Estas acciones dañan la reputación de la empresa y la confianza de los jugadores."
      },
      {
        title: "Robos, red skull/señuelos",
        content: "El robo de muertes (KS), el señuelo (atraer monstruos hacia otros jugadores) y formas de hacer red skull (provocando la pérdida de equipo al obtener calavera roja) son prácticas que, aunque pueden resultar frustrantes, forman parte del entorno competitivo del juego. Mystovia no se hace responsable por robos, estafas, pérdidas de ítems, personajes o cualquier perjuicio sufrido dentro del servidor como consecuencia de interacciones entre jugadores. Cada jugador es plenamente responsable de sus acciones, decisiones y acuerdos realizados dentro del juego. La administración no intervendrá en disputas relacionadas con estas prácticas, salvo en casos en los que se detecte un perjuicio claro y significativo para la estabilidad o el orden del servidor. Es importante recordar que las situaciones de trampa roja podrán ser sancionadas si se detecta uso de multicliente u otras prácticas prohibidas. Las situaciones extremas que generen desequilibrio o desorden en el servidor serán analizadas de manera individual y se aplicarán las medidas correspondientes si fuera necesario. Se alienta a los jugadores a resolver este tipo de conflictos de forma amistosa y con buen comportamiento."
      }
    ]
  },
  {
    id: 2,
    name: "Hacer trampa",
    icon: "Swords",
    rules: [
      {
        title: "Abuso de errores",
        content: "Queda estrictamente prohibido cualquier uso intencional de errores o fallos del juego para obtener ventajas injustas. Esto incluye, entre otros, exploits que afecten la economía del juego, el PvP, la progresión del personaje o cualquier otro aspecto que distorsione la experiencia de juego. Se recomienda a los jugadores que reporten los errores a la administración inmediatamente."
      },
      {
        title: "Verificación",
        content: "La administración del servidor puede realizar comprobaciones periódicas para garantizar que todos los jugadores cumplan las reglas del juego. Esto puede incluir comprobaciones de software, análisis de comportamiento, comprobaciones de bases de datos y otras formas de supervisión. La falta de cooperación o los intentos de obstruir estas comprobaciones se considerarán una infracción de las reglas y podrán conllevar sanciones severas, incluyendo el bloqueo permanente de la cuenta. Nuestras comprobaciones manuales presentarán situaciones inusuales en el juego en las que deberá interactuar con nuestro equipo in situ para evitar un castigo inmediato. Las sanciones se aplicarán junto con la evidencia grabada del jugador por un miembro de nuestro equipo y no serán impugnables por el usuario tras la decisión final del equipo. Además, los bloqueos aplicados mediante comprobaciones externas se basan en el análisis y el cruce de datos con nuestra base de datos y, por lo tanto, también son situaciones que no son impugnables por el usuario."
      },
      {
        title: "Informes",
        content: "Se anima a los jugadores a reportar comportamientos sospechosos o infracciones de las reglas a la administración del servidor. Sin embargo, está prohibido enviar reportes falsos o maliciosos para perjudicar a otros jugadores. El uso responsable del sistema de reportes ayuda a mantener la integridad y la imparcialidad del juego. Usa la herramienta de reportes del juego directamente en tu personaje o en los mensajes de chat."
      },
      {
        title: "Tolerancia",
        content: "La prohibición de la automatización dentro del servidor es nuestra norma más estricta; por lo tanto, aplicaremos sanciones si nuestro equipo la detecta. Recuerde que esta es una verificación manual y dependerá exclusivamente del miembro del equipo que analice el caso en ese momento."
      }
    ]
  },
  {
    id: 3,
    name: "Mensajes y declaraciones",
    icon: "MessageSquare",
    rules: [
      {
        title: "Comportamiento ofensivo",
        content: "Los conflictos verbales forman parte del juego, pero el racismo, sexismo, discriminación, amenazas reales y acoso reiterado están prohibidos y serán sancionados."
      },
      {
        title: "Datos personales",
        content: "Está estrictamente prohibido revelar o solicitar datos personales, dirección, número de teléfono, información bancaria o cualquier otra información confidencial. La seguridad y la privacidad de los jugadores son nuestra prioridad absoluta."
      },
      {
        title: "Publicidad",
        content: "Cualquier tipo de publicidad no autorizada, incluyendo la promoción de otros juegos, productos o servicios comerciales, está estrictamente prohibida. Solo se permiten anuncios aprobados por la administración del servidor, los cuales siempre serán realizados por el personal. El incumplimiento de esta norma puede resultar en advertencias o expulsión."
      },
      {
        title: "SPAM",
        content: "El spam incluye la repetición continua del mismo mensaje, el envío de mensajes irrelevantes en el Chat Mundial, los chats de Publicidad y Ayuda, el uso excesivo de caracteres especiales o cualquier comportamiento que interfiera con la experiencia de juego de otros jugadores. El objetivo es mantener los canales de comunicación claros y útiles para todos."
      },
      {
        title: "Apoyar violaciones de las reglas",
        content: "Está prohibido apoyar o incitar a otros jugadores a infringir las reglas del servidor, ya sea mediante instrucciones, estímulos o cualquier otra forma de ayuda. Esto incluye, entre otros, ayudar a explotar vulnerabilidades, hackear, hacer trampas o cualquier comportamiento que comprometa la integridad del juego."
      }
    ]
  },
  {
    id: 4,
    name: "Balance de PvP",
    icon: "Scale",
    rules: [
      {
        title: "Software",
        content: "Se permite exclusivamente el uso del bot integrado en el cliente oficial de Mystovia. Queda estrictamente prohibido el uso de cualquier programa, script, macro, bot externo, hack o software de terceros que automatice acciones, proporcione ventajas indebidas, revele información no disponible para otros jugadores o interfiera de cualquier forma con el desarrollo normal del juego, especialmente en situaciones de PvP. Se hará especial hincapié en la detección y sanción del uso de herramientas externas durante guerras, tales como scripts de renovación instantánea de muros mágicos, crecimiento salvaje u otras automatizaciones que otorguen ventaja competitiva. Todas las situaciones deberán ser reportadas y evaluadas por el equipo de Mystovia. No se aceptarán imágenes ni vídeos de terceros como método de verificación. El incumplimiento de esta norma podrá resultar en baneo inmediato y permanente, sin derecho a reclamo."
      },
      {
        title: "Multicliente",
        content: "Está estrictamente prohibido ejecutar más de un cliente de juego de manera simultánea con el fin de obtener ventajas en situaciones de PvP, tales como el control de múltiples personajes durante guerras, combates entre jugadores o cualquier enfrentamiento jugador contra jugador. Esta práctica afecta el equilibrio del juego y perjudica la experiencia de la comunidad."
      },
      {
        title: "Combo bot",
        content: "Queda estrictamente prohibido el uso de combo bots o cualquier tipo de automatización que coordine, ejecute o sincronice ataques, hechizos, runas o acciones ofensivas entre uno o más personajes en situaciones de PvP. Esta prohibición incluye tanto programas externos como configuraciones avanzadas, scripts o funciones que permitan realizar combos automáticos sin intervención directa del jugador."
      },
      {
        title: "Pushmax",
        content: "Todo empuje en PvP debe ser realizado manualmente por el jugador. Cualquier automatización, sincronización o repetición automática de empujes será sancionada con baneo permanente."
      }
    ]
  },
  {
    id: 5,
    name: "Ventas y publicaciones",
    icon: "ShoppingBag",
    rules: [
      {
        title: "Comercio permitido",
        content: "Está permitido publicar y comercializar ítems de la store, personajes y cuentas exclusivamente utilizando moneda del juego. Queda estrictamente prohibido publicar, solicitar o acordar precios expresados en dinero real o cualquier medio de pago externo al juego."
      }
    ]
  },
  {
    id: 6,
    name: "Sanciones",
    icon: "Gavel",
    rules: [
      {
        title: "Aplicación de sanciones",
        content: "Mystovia aplica un sistema progresivo de sanciones con el objetivo de mantener el orden y la equidad dentro del servidor. Cada jugador contará con un máximo de cuatro (4) oportunidades. Las infracciones que no sean consideradas graves o determinantes para el correcto funcionamiento del servidor serán sancionadas mediante advertencias (warnings). Al alcanzar tres (3) warnings, el jugador será sancionado con un baneo temporal de tres (3) días. Una vez cumplido y levantado dicho baneo temporal, cualquier nueva infracción al reglamento resultará en un baneo permanente, sin posibilidad de apelación. Las infracciones graves, reiteradas o que perjudiquen de forma directa la estabilidad, la economía o la experiencia general del servidor podrán ser sancionadas con baneo permanente inmediato, independientemente del número de warnings acumulados."
      }
    ]
  }
];

// Icon mapping function
const getIconComponent = (iconName: string) => {
  const icons: Record<string, any> = {
    Shield,
    Swords,
    MessageSquare,
    Scale,
    ShoppingBag,
    Gavel
  };
  return icons[iconName] || Shield;
};
---

<Layout
  title="Reglas del Servidor"
  description="Lee las reglas oficiales de Mystovia. Conoce las normas de conducta, reglas de PvP, sanciones y todo lo necesario para jugar correctamente."
  keywords="reglas mystovia, normas tibia server, reglas pvp, sanciones, conducta servidor"
>
  <section class="page-container">
    <!-- Header with medieval style -->
    <div class="mb-6 sm:mb-8 text-center">
      <div class="flex items-center justify-center gap-3 mb-3">
        <div class="h-px w-8 sm:w-12 bg-gradient-to-r from-transparent to-yellow-500/50"></div>
        <Diamond class="w-4 h-4 text-yellow-500/70" fill="currentColor" />
        <div class="h-px w-8 sm:w-12 bg-gradient-to-l from-transparent to-yellow-500/50"></div>
      </div>
      <div class="flex items-center justify-center gap-3 mb-3 sm:mb-4">
        <BookOpenText class="w-6 h-6 sm:w-8 sm:h-8 text-yellow-500" />
        <h1 id="rulesTitle" class="text-2xl sm:text-3xl md:text-4xl font-bold text-yellow-500 medieval-font">Reglas del Servidor</h1>
      </div>
      <p id="rulesSubtitle" class="text-sm sm:text-base md:text-lg text-gray-400 max-w-2xl mx-auto">
        Por favor, lee y respeta las siguientes reglas para asegurar una experiencia agradable para todos los jugadores.
      </p>
    </div>

    <!-- Warning message -->
    <div class="relative rounded-xl overflow-hidden p-3 sm:p-4 mb-6 border border-amber-600/30"
         style="background: linear-gradient(to right, rgb(120 53 15 / 0.3), rgb(17 24 39 / 0.9));">
      <div class="absolute top-0 left-0 right-0 h-0.5 bg-gradient-to-r from-amber-500/50 via-transparent to-transparent"></div>
      <div class="flex items-start gap-3 relative z-10">
        <AlertTriangle class="w-5 h-5 text-amber-500 shrink-0 mt-0.5" />
        <p id="rulesWarning" class="text-xs sm:text-sm text-amber-200">
          El incumplimiento de estas reglas puede resultar en sanciones que van desde advertencias hasta baneos permanentes. Ignorar las reglas no es excusa.
        </p>
      </div>
    </div>

    <!-- Table of Contents -->
    <div class="relative rounded-xl overflow-hidden p-4 sm:p-6 mb-6 border border-yellow-600/20"
         style="background: linear-gradient(to bottom, rgb(17 24 39 / 0.95), rgb(0 0 0 / 0.9));">
      <DiamondPattern opacity={0.02} class="rounded-xl" />
      <GoldenLine position="top" opacity={0.4} />

      <h2 id="rulesToC" class="text-lg font-bold text-yellow-500 mb-4 medieval-font relative z-10">Indice de Secciones</h2>
      <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3 relative z-10">
        {sections.map((section, index) => (
          <a href={`#section-${section.id}`}
             class="flex items-center gap-2 p-2 sm:p-3 rounded-lg border border-yellow-600/20 hover:border-yellow-500/40 transition-all text-gray-300 hover:text-yellow-500 group"
             style="background: linear-gradient(to bottom, rgb(31 41 55 / 0.5), rgb(17 24 39 / 0.7));">
            <span class="w-6 h-6 flex items-center justify-center rounded bg-yellow-500/10 text-yellow-500 text-xs font-bold group-hover:bg-yellow-500/20 transition-colors">
              {index + 1}
            </span>
            <span class="text-xs sm:text-sm truncate toc-section-name" data-section-id={section.id}>{section.name}</span>
          </a>
        ))}
      </div>
    </div>

    <!-- Rules Sections -->
    <div class="space-y-6 sm:space-y-8">
      {sections.map((section, sectionIndex) => {
        const IconComponent = getIconComponent(section.icon);
        return (
          <article id={`section-${section.id}`}
                   class="relative rounded-xl overflow-hidden border border-yellow-600/20 scroll-mt-24"
                   style="background: linear-gradient(to bottom, rgb(17 24 39 / 0.95), rgb(0 0 0 / 0.9));">
            <DiamondPattern opacity={0.02} class="rounded-xl" />
            <GoldenLine position="top" />
            <CornerOrnaments variant="curve" size="xs" opacity={0.3} />

            <!-- Section Header -->
            <div class="p-4 sm:p-6 border-b border-yellow-600/20 relative z-10"
                 style="background: linear-gradient(to right, rgb(234 179 8 / 0.05), transparent);">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 sm:w-12 sm:h-12 rounded-lg flex items-center justify-center border border-yellow-500/30"
                     style="background: linear-gradient(to bottom, rgb(234 179 8 / 0.15), rgb(234 179 8 / 0.05));">
                  <IconComponent class="w-5 h-5 sm:w-6 sm:h-6 text-yellow-500" />
                </div>
                <div>
                  <span class="text-xs text-yellow-500/60 uppercase tracking-wider section-label" data-section-index={sectionIndex + 1}>Seccion {sectionIndex + 1}</span>
                  <h2 class="text-lg sm:text-xl md:text-2xl font-bold text-yellow-500 medieval-font section-name" data-section-id={section.id}>{section.name}</h2>
                </div>
              </div>
            </div>

            <!-- Rules List -->
            <div class="p-4 sm:p-6 space-y-4 relative z-10">
              {section.rules.map((rule, ruleIndex) => (
                <div class="relative pl-4 sm:pl-6 border-l-2 border-yellow-500/30 hover:border-yellow-500/60 transition-colors group">
                  <div class="absolute left-[-5px] top-0 w-2 h-2 rounded-full bg-yellow-500/50 group-hover:bg-yellow-500 transition-colors"></div>
                  <h3 class="text-sm sm:text-base font-semibold text-white mb-1 group-hover:text-yellow-500 transition-colors rule-title"
                      data-section-id={section.id}
                      data-rule-id={ruleIndex + 1}
                      data-prefix={`${sectionIndex + 1}.${ruleIndex + 1}`}>
                    {sectionIndex + 1}.{ruleIndex + 1} {rule.title}
                  </h3>
                  <p class="text-xs sm:text-sm text-gray-400 leading-relaxed rule-content"
                     data-section-id={section.id}
                     data-rule-id={ruleIndex + 1}>{rule.content}</p>
                </div>
              ))}
            </div>
          </article>
        );
      })}
    </div>

    <!-- Info message -->
    <div class="relative rounded-xl overflow-hidden p-4 sm:p-5 mt-8 border border-blue-600/30"
         style="background: linear-gradient(to right, rgb(30 58 138 / 0.3), rgb(17 24 39 / 0.9));">
      <div class="absolute top-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500/50 via-transparent to-transparent"></div>
      <div class="flex items-start gap-3 relative z-10">
        <Info class="w-5 h-5 text-blue-400 shrink-0 mt-0.5" />
        <div>
          <p id="rulesAcceptTitle" class="text-sm sm:text-base text-blue-200 font-medium mb-1">Aceptacion de reglas</p>
          <p id="rulesAcceptText" class="text-xs sm:text-sm text-blue-300/80">
            Al jugar en Mystovia, aceptas cumplir con todas estas reglas. El desconocimiento de las mismas no exime de su cumplimiento. Si tienes dudas sobre alguna regla, contacta al staff.
          </p>
        </div>
      </div>
    </div>

    <!-- Back to top button -->
    <div class="flex justify-center mt-8">
      <a href="#" class="btn-medieval btn-medieval-secondary text-sm">
        <ArrowUp class="w-4 h-4" />
        <span id="rulesBackTop">Volver arriba</span>
      </a>
    </div>
  </section>
</Layout>

<script>
  import { t, getStoredLanguage } from '../i18n/translations';

  function applyTranslations() {
    const lang = getStoredLanguage();

    const rulesTitle = document.getElementById('rulesTitle');
    if (rulesTitle) rulesTitle.textContent = t('rules.title', lang);

    const rulesSubtitle = document.getElementById('rulesSubtitle');
    if (rulesSubtitle) rulesSubtitle.textContent = t('rules.subtitle', lang);

    const rulesWarning = document.getElementById('rulesWarning');
    if (rulesWarning) rulesWarning.textContent = t('rules.warning', lang);

    const rulesToC = document.getElementById('rulesToC');
    if (rulesToC) rulesToC.textContent = t('rules.tableOfContents', lang);

    const rulesAcceptTitle = document.getElementById('rulesAcceptTitle');
    if (rulesAcceptTitle) rulesAcceptTitle.textContent = t('rules.acceptanceTitle', lang);

    const rulesAcceptText = document.getElementById('rulesAcceptText');
    if (rulesAcceptText) rulesAcceptText.textContent = t('rules.acceptanceText', lang);

    const rulesBackTop = document.getElementById('rulesBackTop');
    if (rulesBackTop) rulesBackTop.textContent = t('rules.backToTop', lang);

    // Translate table of contents section names
    document.querySelectorAll('.toc-section-name').forEach(el => {
      const sectionId = el.getAttribute('data-section-id');
      if (sectionId) {
        el.textContent = t(`rules.sections.${sectionId}.name`, lang);
      }
    });

    // Translate section labels
    document.querySelectorAll('.section-label').forEach(el => {
      const sectionIndex = el.getAttribute('data-section-index');
      if (sectionIndex) {
        el.textContent = `${t('rules.section', lang)} ${sectionIndex}`;
      }
    });

    // Translate section names (headers)
    document.querySelectorAll('.section-name').forEach(el => {
      const sectionId = el.getAttribute('data-section-id');
      if (sectionId) {
        el.textContent = t(`rules.sections.${sectionId}.name`, lang);
      }
    });

    // Translate rule titles
    document.querySelectorAll('.rule-title').forEach(el => {
      const sectionId = el.getAttribute('data-section-id');
      const ruleId = el.getAttribute('data-rule-id');
      const prefix = el.getAttribute('data-prefix');
      if (sectionId && ruleId) {
        el.textContent = `${prefix} ${t(`rules.sections.${sectionId}.rules.${ruleId}.title`, lang)}`;
      }
    });

    // Translate rule content
    document.querySelectorAll('.rule-content').forEach(el => {
      const sectionId = el.getAttribute('data-section-id');
      const ruleId = el.getAttribute('data-rule-id');
      if (sectionId && ruleId) {
        el.textContent = t(`rules.sections.${sectionId}.rules.${ruleId}.content`, lang);
      }
    });
  }

  applyTranslations();
  document.addEventListener('astro:page-load', applyTranslations);
</script>
